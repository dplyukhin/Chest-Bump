<!DOCTYPE html>
<html>
<head>
<!-- Load the Paper.js library -->
<script type="text/javascript" src="scripts/paper.js"></script>

<script type="text/x-paperscript" canvas="myCanvas">

var BOX_TOP_SPEED = 15;
var GRAVITY = 1;
var NUM_PLAYERS = 1;

var boxie = function (){

    var rectangle = new Rectangle({
	    point: view.center,
	    size: new Size(20, 20)
    });
    
    var cornerSize = new Size(2, 2);
    
    var mr_boxie = new Path.Rectangle(rectangle, cornerSize);
    mr_boxie.strokeColor = 'white';
    mr_boxie.fillColor = 'white';
      
    vel_i = new Point(0, 0);
    
    return {

	    //Velocity vector
	    velocity: vel_i,
	    
	    //Change in position, delta_p is a POINT
	    change_p: function (v) {
	        mr_boxie.position += v;
	    }
	    
    }
};

//Initialize defaults
PLAYERS = []

for( var i=0; i < NUM_PLAYERS; i++ ){
    PLAYERS.push( new boxie() );
}

PLAYERS[0].velocity.y -= 20;

function onFrame() {

    var v = PLAYERS[0].velocity;
    var move = 0;   //The 'force' of the keyboard
    v.y += GRAVITY;

    if (Key.isDown('left'))
	    move = -BOX_TOP_SPEED;
    
    if (Key.isDown('right'))
	    move = BOX_TOP_SPEED;
	    
	//INERTIA
	move *= (Math.abs(v.x) + 1) / (Math.abs(move) + 1);
	
	v.x = move;
    
    PLAYERS[0].change_p( v );
}
	
</script>	

</head>

<body>
	<canvas id="myCanvas" resize style="display:block; width:100%; height:100%; background-color:black"></canvas>
</body>
</html>
